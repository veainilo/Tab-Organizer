<!DOCTYPE html>
<html>
<head>
  <title>Edge Tab Organizer</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="css/popup.css">
</head>
<body>
  <h1 data-i18n="extName">Edge Tab Organizer</h1>

  <div class="section">
    <!-- 插件激活开关 -->
    <div class="toggle-container">
      <label class="switch">
        <input type="checkbox" id="extensionActiveToggle" checked>
        <span class="slider round"></span>
      </label>
      <div class="toggle-info">
        <div class="toggle-title">
          <span class="status-indicator status-active" id="extensionActiveIndicator"></span>
          <span id="extensionActiveStatus">插件已激活</span>
        </div>
        <div class="toggle-description">启用或禁用标签页自动分组功能</div>
      </div>
    </div>

    <!-- 持续监控开关 -->
    <div class="toggle-container">
      <label class="switch">
        <input type="checkbox" id="monitoringToggle" checked>
        <span class="slider round"></span>
      </label>
      <div class="toggle-info">
        <div class="toggle-title">
          <span class="status-indicator status-active" id="monitoringIndicator"></span>
          <span id="monitoringStatus">持续监控已启用</span>
          <div class="interval-input">
            <span>间隔:</span>
            <input type="number" id="monitoringInterval" min="1000" step="1000" value="5000">
            <span>毫秒</span>
            <div class="countdown-container">
              <span class="countdown-label">下次执行:</span>
              <span class="countdown" id="monitoringCountdown"></span>
            </div>
          </div>
        </div>
        <div class="toggle-description">自动监控标签页状态并进行分组和排序</div>
      </div>
    </div>
  </div>

  <div class="section">
    <h3 class="section-title">
      <i>⚡</i>快速操作
    </h3>
    <div class="button-container">
      <div class="button-row">
        <div class="button-col-2">
          <button id="groupByDomain" data-i18n="groupByDomain">
            <i>📊</i>按域名分组
          </button>
        </div>
        <div class="button-col-2">
          <button id="ungroupAll" data-i18n="ungroupAll">
            <i>🔄</i>取消所有分组
          </button>
        </div>
      </div>
      <div class="button-row">
        <div class="button-col-2">
          <button id="sortTabs" data-i18n="sortTabs">
            <i>📋</i>组内标签排序
          </button>
        </div>
        <div class="button-col-2">
          <button id="sortGroups" data-i18n="sortGroups">
            <i>📑</i>标签组排序
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="status" class="status"></div>

  <div class="tab-container">
    <div class="tab-buttons">
      <button class="tab-button active" data-tab="groups">当前标签组</button>
      <button class="tab-button" data-tab="metrics">排序指标</button>
      <button class="tab-button" data-tab="debug">调试</button>
    </div>

    <div class="tab-content active" id="groups-tab">
      <div id="groupList" class="group-list">
        <div id="noGroups" data-i18n="noGroups" style="padding: 15px; text-align: center; color: #666;">No tab groups found</div>
      </div>
    </div>

    <div class="tab-content" id="metrics-tab">
      <div class="sorting-settings-container">
        <h3 class="metrics-title">
          <i>⚙️</i>
          <span>排序设置</span>
        </h3>

        <div class="sorting-settings">
          <div class="sorting-section">
            <h4>标签组排序</h4>
            <div class="sorting-option">
              <label>排序方法:</label>
              <select id="groupSortingMethod">
                <option value="title">按标题</option>
                <option value="size">按大小</option>
                <option value="smart" selected>智能排序</option>
              </select>
            </div>
            <div class="sorting-option">
              <label>排序顺序:</label>
              <button id="groupSortOrder" class="sort-order-button">
                <span id="groupSortOrderIcon">↑</span>
                <span id="groupSortOrderText">升序</span>
              </button>
            </div>
          </div>

          <div class="sorting-section">
            <h4>组内标签排序</h4>
            <div class="sorting-option">
              <label>排序方法:</label>
              <select id="tabSortingMethod">
                <option value="title">按标题</option>
                <option value="domain" selected>按域名</option>
                <option value="smart">智能排序</option>
              </select>
            </div>
            <div class="sorting-option">
              <label>排序顺序:</label>
              <button id="tabSortOrder" class="sort-order-button">
                <span id="tabSortOrderIcon">↑</span>
                <span id="tabSortOrderText">升序</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="sortingMetricsContainer" class="sorting-metrics-container">
        <h3 class="metrics-title">
          <i>📊</i>
          <span data-i18n="sortingMetrics">排序指标</span>
        </h3>
        <div id="sortingMetrics" class="sorting-metrics"></div>
      </div>
    </div>

    <div class="tab-content" id="debug-tab">
      <!-- 调试按钮 -->
      <div class="button-container">
        <button id="testConnection" class="button-secondary">测试连接</button>
        <button id="testGroupByDomain" class="button-secondary">测试分组</button>
        <button id="testUngroupAll" class="button-secondary">测试取消分组</button>
        <button id="testSortTabGroups" class="button-secondary">测试排序</button>
        <button id="testGetSortingMetrics" class="button-secondary">测试获取指标</button>
      </div>
    </div>
  </div>

  <a href="options.html" class="settings-link" target="_blank" data-i18n="settings">
    ⚙️ 设置
  </a>

  <script type="module" src="js/popup/main.js"></script>
</body>
</html>
